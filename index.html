<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculadora Paralelo | Conversor de Monedas</title>
  <meta name="description" content="Calculadora para conversión de monedas BOB a USD, EUR y criptomonedas al tipo de cambio paralelo">
  
  <!-- Preconexión y precarga de recursos -->
  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  <link rel="preconnect" href="https://paralelo.scz.red">
  <link rel="preload" href="styles.css" as="style">
  <link rel="preload" href="app.js" as="script">
  
  <!-- Hojas de estilo -->
  <link href="https://fonts.cdnfonts.com/css/satoshi" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="styles.css">
  
  <!-- Manifest PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#3a0ca3">
  
  <!-- Meta tags iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Calculadora Paralelo">
  <link rel="apple-touch-icon" href="icons/icon-192x192.png">
  
  <!-- Favicon -->
  <link rel="icon" href="icons/icon-192x192.png" type="image/png">
</head>
<body>
  <div class="app-container">
    <div class="header">
      <svg class="wave-bg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
        <path fill="rgba(255,255,255,0.1)" d="M0,192L48,197.3C96,203,192,213,288,229.3C384,245,480,267,576,250.7C672,235,768,181,864,181.3C960,181,1056,235,1152,234.7C1248,235,1344,181,1392,154.7L1440,128L1440,0L1392,0C1344,0,1248,0,1152,0C1056,0,960,0,864,0C768,0,672,0,576,0C480,0,384,0,288,0C192,0,96,0,48,0L0,0Z"></path>
      </svg>
<div class="header">
  <img src="icons/baner.png" alt="Paralelo Bolivia" class="logo-principal" style="max-width: 210px; display: block; margin: 0 auto 16px auto;">

  <p>Convierte BOB a diferentes monedas al instante</p>
</div>


    
    <div class="input-container">
      <div class="input-group">
        <label for="monto">Monto a convertir</label>
        <input type="number" id="monto" min="1" value="1000" placeholder="Ej: 1000" autofocus>
        <span class="currency-selector">BOB</span>
      </div>
      
      <div class="tasas-referencia">
        <div class="tasa-item">
          <div class="tasa-monedas">USD/BOB</div>
          <div class="tasa-valor" id="tasa-usd">--</div>
        </div>
        <div class="tasa-item">
          <div class="tasa-monedas">EUR/BOB</div>
          <div class="tasa-valor" id="tasa-eur">--</div>
        </div>
      </div>
    </div>
    
    <div class="results" aria-live="polite" aria-atomic="true">
      <div class="section-title">
        <i class="fas fa-money-bill-wave"></i>
        <span>Monedas tradicionales</span>
      </div>
      <ul class="currency-list" id="fiat-list"></ul>
      
      <div class="section-title">
        <i class="fas fa-coins"></i>
        <span>Criptomonedas</span>
      </div>
      <ul class="currency-list" id="crypto-list"></ul>
      
      <div id="loader-global" style="display:none;" role="status" aria-live="polite">
        <div class="loading">
          <i class="fas fa-spinner fa-spin"></i>
          Calculando tasas de cambio...
        </div>
      </div>
    </div>
    
    <!-- Botón de instalación PWA (se muestra dinámicamente) -->
    <div id="install-container" class="pwa-install-container hidden">
      <button id="install-btn" class="pwa-install-btn">
        <i class="fas fa-download"></i> Instalar App
      </button>
    </div>
  </div>

  <!-- Scripts -->
  <script src="script.js" defer></script>
  <script src="app.js" defer></script>
  
  <!-- Registro del Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('sw.js')
          .then(registration => {
            console.log('Service Worker registrado:', registration.scope);
          })
          .catch(error => {
            console.log('Error registrando Service Worker:', error);
          });
      });
    }
  </script>
<script>
// Detección de plataforma
function getMobilePlatform() {
  const ua = navigator.userAgent || navigator.vendor || window.opera;
  if (/android/i.test(ua)) return "android";
  if (/iPad|iPhone|iPod/.test(ua) && !window.MSStream) return "ios";
  return "other";
}

const platform = getMobilePlatform();
const installContainer = document.getElementById('pwa-install-container');
const installBtn = document.getElementById('pwa-install-btn');
const installText = document.getElementById('pwa-install-text');

let deferredPrompt = null;

if (platform === "android") {
  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    installContainer.style.display = "block";
    installText.textContent = "Instalar app en tu Android";
    installBtn.onclick = async () => {
      if (deferredPrompt) {
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        if (outcome === 'accepted') installContainer.style.display = "none";
        deferredPrompt = null;
      }
    };
  });
}

if (platform === "ios") {
  // Solo mostrar si está en Safari, no en Chrome
  const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
  if (isSafari) {
    installContainer.style.display = "block";
    installText.textContent = "¿Cómo instalar en tu iPhone?";
    installBtn.onclick = () => {
      document.getElementById('ios-guide-modal').style.display = "flex";
    };
  }
}
</script>
    <script>
document.addEventListener('DOMContentLoaded', function() {
  const logo = document.querySelector('.logo-principal');
  if (logo) {
    logo.addEventListener('load', () => logo.classList.add('loaded'));
    // Si la imagen ya está cargada (por cache), aplica la clase de inmediato
    if (logo.complete) logo.classList.add('loaded');
  }
});
</script>


  <!-- Botón de instalación PWA (flotante) -->
<div id="pwa-install-container" class="pwa-install-container" style="display:none;">
  <button id="pwa-install-btn" class="pwa-install-btn">
    <i class="fas fa-download"></i>
    <span id="pwa-install-text"></span>
  </button>
</div>

<!-- Modal guía iOS -->
<div id="ios-guide-modal" class="install-guide-modal" style="display:none;">
  <div class="guide-content">
    <h3>¿Cómo instalar la app en tu iPhone?</h3>
    <ol>
      <li>
        Abre esta web en <b>Safari</b>.<br>
        Pulsa 
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3e/IOS_Safari_Share_icon.png/32px-IOS_Safari_Share_icon.png" alt="Share" style="height:22px;vertical-align:middle;">
        <b>Compartir</b>
      </li>
      <li>
        Selecciona <b>Agregar a pantalla de inicio</b>
        <img src="https://upload.wikimedia.org/wikipedia/commons/8/89/IOS_Add_to_Home_Screen_icon.png" alt="Add" style="height:22px;vertical-align:middle;">
      </li>
      <li>
        Confirma con <b>Agregar</b>
      </li>
    </ol>
    <button onclick="document.getElementById('ios-guide-modal').style.display='none'" class="close-modal">Cerrar</button>
  </div>
</div>
<!-- FIN instalación PWA -->

</body>
</html>
